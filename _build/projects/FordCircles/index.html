

<!DOCTYPE html>
<html lang="en">
  <head>
    
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link rel="icon" href="/favicon.svg" type="image/svg+xml">
      
        <meta name="description" content="View Ford circles.">
      
      
      <style>
        /*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:0.67em 0}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}details{display:block}summary{display:list-item}html{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}*,*::before,*::after{-webkit-box-sizing:inherit;-moz-box-sizing:inherit;box-sizing:inherit}
 
        :root{--colorWhite:#f2f2f2;--colorBlack:black;--colorPrimary:#17434f;--colorSecondary:#f2f2f2;--colorAccent:#266651}

      </style>
      <link rel="stylesheet" href="/katex_0.15.2.css">
      <title>Ford Circles</title>
    
  </head>
  <body>
    <div class="root root-fullscreen">
      
        <nav class="n-c">
  <style>html,body{width:100%;height:100%}body{margin:0;padding:0;font-family:"Times New Roman",serif}h1,h2,h3,h4,h5,h6,nav{font-family:"Times New Roman",serif}.root{display:flex;flex-flow:column;width:100%;margin:0;padding:0}.root-fullscreen{overflow:hidden;height:100%}.main{flex-grow:1}.main-text{padding:0 10%}.n-c{width:100%;font-family:"Calibri",serif;color:black;background:white;padding:0 10%;outline:1px solid black;z-index:1000}.n-c a{text-decoration:underline dotted 1px;color:currentColor;white-space:nowrap}.n-c a:hover,.n-c a:focus{text-decoration:underline 2px;color:black;background:var(--colorSecondary)}.n-c>a{display:block;float:left;height:40px;vertical-align:middle;line-height:40px;font-size:1.3em;font-weight:bold}.n-ul1{display:inline-block;flex-wrap:wrap;gap:0 30px;padding:0;list-style-type:none;width:100%;background:transparent;color:black}.n-ul1 a,.n-ul1 span{font-weight:bold}.n-li1{flex-grow:1;flex-basis:auto;display:block;padding:0 10px 0;margin-bottom:10px;border-left:1px solid black;border-right:1px solid black}#nav-cbox{display:none}#nav-cbox:checked~.n-ul1{display:none}.n-ul2{display:block;list-style-type:none;padding:0;color:black;}.n-ul2 a,.n-ul2 span{font-weight:normal}.n-b{float:right;display:block;width:40px;height:40px;padding:10px;color:black}.n-b:hover{color:black;background:var(--colorSecondary)}@media (min-width:770px){.n-b{display:none}#nav-cbox:checked~.n-ul1{display:block}.n-ul1{display:block;float:left;width:auto;height:40px;padding-left:2em;margin:0}.n-li1{all:unset;display:block;height:40px;width:max-content;position:relative;float:left}.n-li1>a,.n-li1>span{margin-left:15px;font-size:1.3em;vertical-align:middle;line-height:40px}.n-li1>span::after{content:"â—‚";display:inline-block;margin-left:3pt;transform:scale(0.75);transition:transform 100ms}.n-li1:hover>span::after,.n-li1:focus-within>span::after{transform:scale(0.75) rotate(-90deg)}.n-li1:hover>.n-ul2,.n-li1:focus-within>.n-ul2{display:block}.n-ul2{display:none;position:absolute;background:white;min-width:100%;border:1px solid black;border-top:none;padding:0}.n-li2{display:block;width:100%;height:30px;}.n-li2>a{display:block;min-width:100%;height:100%;line-height:30px;padding:0 20px;box-sizing:border-box;whitespace:nowrap;text-align:middle}}
</style>
  <input id="nav-cbox" type="checkbox" checked="checked" style="display: none;" />

  <a href="/"> Leo's Homepage </a>

  <label for="nav-cbox" tabindex="0" class="n-b">
    <svg style="display:block;width:100%;height:100%;max-width:100px;" viewBox="0 0 10 10">
      <path
        d="M0,2 10,2M0,5 10,5M0,8 10,8"
        stroke="currentColor"
        stroke-width="1"
      />
    </svg>
  </label>
  <ul class="n-ul1"><li class="n-li1"><span tabindex="0">Web Apps</span><ul class="n-ul2"><li class="n-li2"><a href="/projects/Hyperbola/">Hyperbolamethod</a></li><li class="n-li2"><a href="/projects/SubgroupsTest/">Congruence Subgroups</a></li><li class="n-li2"><a href="/projects/Subgroups/">Subgroups</a></li><li class="n-li2"><a href="/projects/FareyFractions/">Farey Fractions</a></li><li class="n-li2"><a href="/projects/FordCircles/">Ford Circles</a></li></ul></li><li class="n-li1"><a href="/projects/">All Projects</a></li><li class="n-li1"><span tabindex="0">Tiny Projects</span><ul class="n-ul2"><li class="n-li2"><a href="/projects/textTest/">SVG Test</a></li></ul></li></ul>
</nav>

        <main class="main main-fullscreen">
          
            <script >(()=>{var xe=Object.defineProperty;var Q=Object.getOwnPropertySymbols;var we=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable;var $=Math.pow,j=(i,e,t)=>e in i?xe(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,_=(i,e)=>{for(var t in e||(e={}))we.call(e,t)&&j(i,t,e[t]);if(Q)for(var t of Q(e))Te.call(e,t)&&j(i,t,e[t]);return i};var O=(i,e,t)=>new Promise((n,r)=>{var a=m=>{try{o(t.next(m))}catch(d){r(d)}},s=m=>{try{o(t.throw(m))}catch(d){r(d)}},o=m=>m.done?n(m.value):Promise.resolve(m.value).then(a,s);o((t=t.apply(i,e)).next())});var D=class{constructor(){this.map=new Map}getNew(e,t){return{create:()=>{let n=this.map,r;n.has(e)?r=n.get(e):(r=[],n.set(e,r));let a=new ee(t);return r.push(a),a}}}abortAll(e){if(!this.map.has(e))return;let t=this.map.get(e);for(let n of t)n.aborted=!0;this.map.delete(e)}},ee=class{constructor(e=16){this.I=-1;this.i=0;this.t=performance.now();this.aborted=!1;this.d=e}begin(){this.t0=this.t=performance.now()}done(){if(this.aborted)throw console.debug("A task was aborted!"),"aborted";this.aborted=!0;let e=performance.now()-(this.t0||performance.now());e>1500&&console.debug("Long Task Took: "+Math.round(e)+"ms")}shouldYield(){return this.i++<this.I?!1:(this.I=-1)?performance.now()-this.t>=this.d:!0}yield(){return O(this,null,function*(){if(this.t){let e=performance.now()-this.t;this.I=Math.max(1,this.i*Math.min(this.d/(e+1),4))}if(yield ke(0),this.aborted)throw console.debug("A task was aborted!"),"aborted";this.i=0,this.t=performance.now()})}};function te(i,e,t,n){return O(this,null,function*(){var o,m;n!=null||(n=_e);let r=n.create();(o=r.begin)==null||o.call(r);let a=e.apply(i,t),s=a.next();for(;!s.done;)r.shouldYield()&&(yield r.yield()),s=a.next();return(m=r.done)==null||m.call(r),s.value})}function ne(i,e,t){let n=e.apply(i,t),r=n.next();for(;!r.done;)r=n.next();return r.value}var _e={create:()=>({shouldYield(){return!1},yield(){return O(this,null,function*(){})}})};function ke(i){return new Promise(e=>setTimeout(e,i))}function re(i){let e=i[i.length-1],t;return"create"in e&&(i=Array.prototype.slice.call(i,0,i.length-1),t=e),[t,i]}var I;(function(t){function i(n){return function(...a){let[s,o]=re(a);return te(this,n,o,s)}}t.async=i;function e(n){return function(...a){return ne(this,n,a)}}t.sync=e})(I||(I={}));var R;(function(t){function i(n){return function(...a){let[s,o]=re(a);return te(this,this[n],o,s)}}t.async=i;function e(n){return function(...a){return ne(this,this[n],a)}}t.sync=e})(R||(R={}));var E;(function(n){n.Infinity="infinity",n.Complex="complex",n.Moebius="moebius"})(E||(E={}));var H={mathtype:E.Infinity},Me=class{constructor(e,t,n=1){this.start=e;this.end=t;this.step=n}*[Symbol.iterator](){let{start:e,step:t,end:n}=this;for(;e<n;)yield e,e+=t}};function Ce(i,e){return typeof i=="number"?new v(i,e):Array.isArray(i)?new v(i[0],i[1]):i}var v=class{constructor(e,t=0){this.mathtype=E.Complex;this.real=e,this.imag=t}abs2(){return this.real*this.real+this.imag*this.imag}abs(){return Math.sqrt(this.abs2())}add(e){return typeof e=="number"?new v(this.real+e,this.imag):new v(this.real+e.real,this.imag+e.imag)}sub(e){return typeof e=="number"?new v(this.real-e,this.imag):new v(this.real-e.real,this.imag-e.imag)}mul(e){return typeof e=="number"?new v(e*this.real,e*this.imag):new v(this.real*e.real-this.imag*e.imag,this.imag*e.real+this.real*e.imag)}div(e){return typeof e=="number"?new v(this.real/e,this.imag/e):this.mul(e.inv())}inv(){var e=this.abs2();return new v(this.real/e,-this.imag/e)}arg(){var e=this.real,t=this.imag;if(e==0)return t>0?.5*Math.PI:t<0?1.5*Math.PI:0;if(e>=0){let n=Math.atan(1*t/e);return n<0?2*Math.PI+n:n}return Math.atan(1*t/e)+Math.PI}toTeX(){return this.imag==0?`${this.real}`:this.real==0?`${this.imag}i`:`${this.real} + ${this.imag}i`}},T=class{constructor(e,t,n,r){this.mathtype=E.Moebius;this.m=[e,t,n,r]}mul(e){let t=this.m,n=e.m;return new T(t[0]*n[0]+t[1]*n[2],t[0]*n[1]+t[1]*n[3],t[2]*n[0]+t[3]*n[2],t[2]*n[1]+t[3]*n[3])}inv(){let e=this.m;return new T(e[3],-e[1],-e[2],e[0])}transform(e,t){if(typeof e=="number")e=Ce(e,t);else if(e.mathtype===E.Infinity)return this.m[2]==0?H:new v(this.m[0]/this.m[2]);let n=this.m,r=e.mul(n[2]).add(n[3]);return r.real==0&&r.imag==0?H:e.mul(n[0]).add(n[1]).div(r)}toTeX(){return`\\begin{pmatrix}${this.m[0]}&${this.m[1]}\\\\ ${this.m[2]}&${this.m[3]}\\end{pmatrix}`}},ie;(function(p){class i{constructor(l,h){this.cosetRepresentatives=R.sync("_cosetRepresentatives");this.cosetRepresentativesAsync=R.async("_cosetRepresentatives");this.indicator=l,this.tex=h}findCosetIndex(l,h,c){let f=c.inv(),b=this.indicator;for(var g=0;g<h.length;g++)if(b(l,h[g].mul(f)))return g;return-1}findCoset(l,h,c){let f=c.inv(),b=this.indicator;return h.find(g=>b(l,g.mul(f)))}*_cosetRepresentatives(l){if(!Number.isInteger(l)||l<=0)throw"Invalid Level";let h=[new T(0,-1,1,0),new T(1,1,0,1),new T(1,-1,0,1)],c=this,f=[new T(1,0,0,1)];for(var b=[],g=[],w=[new T(1,0,0,1)];w.length>0;){b=g,g=w,w=[];for(let M of g)for(let B of h){yield;let C=M.mul(B);c.findCosetIndex(l,b,C)==-1&&c.findCosetIndex(l,w,C)==-1&&c.findCosetIndex(l,g,C)==-1&&(f.push(C),w.push(C))}}return f}toTeX(){return this.tex}}p.CongruenceSubgroup=i;function e(u,l,h){return(u-l)%h==0}function t(u,l){return e(l.m[2],0,u)}p.Gamma_0=new i(t,"\\Gamma_0");function r(u,l){return e(l.m[2],0,u)&&(e(l.m[0],1,u)||e(l.m[0],-1,u))}p.Gamma_1=new i(r,"\\Gamma_1");function s(u,l){return e(l.m[2],0,u)&&e(l.m[1],0,u)&&(e(l.m[0],1,u)||e(l.m[0],-1,u))}p.Gamma=new i(s,"\\Gamma"),p.Gamma.cosetRepresentatives=function(u){let l=p.Gamma_1.cosetRepresentatives(u),h=[];for(let c=0;c<u;c++){let f=new T(1,c,0,1);h.push(...l.map(b=>f.mul(b)))}return h},p.Gamma._cosetRepresentatives=function*(u){let l=yield*p.Gamma_1._cosetRepresentatives(u),h=[];for(let c=0;c<u;c++){yield;let f=new T(1,c,0,1);h.push(...l.map(b=>f.mul(b)))}return h};let m=new v(Math.cos(Math.PI/3),Math.sin(Math.PI/3));p.Domain1={corners:[H,m,new v(0,1),new v(-m.real,m.imag)],findCosetOf(u,l=100){if(u.imag<=0)return;let h=new T(1,0,0,1),c=u;for(var f=0;f<l;f++){if(c==H)return h.inv();var b=Math.floor(c.real+.5);if(h=new T(1,-b,0,1).mul(h),c=h.transform(u),c.abs2()>=1)return h.inv();h=new T(0,1,-1,0).mul(h),c=h.transform(u)}console.log("Max iterations in 'findMoebiousToFund' reached")}}})(ie||(ie={}));var ae=2*Math.PI,se=.5/Math.PI,S=class{constructor(e,t,n){this._lineWidth=1;this._fontSize=13;this._fillColor="#000000";this._strokeColor="#000000";this.fontAscent=-1;this.fontDescent=-1;this._ctx=e,this.width=t===void 0?e.canvas.width:t,this.height=n===void 0?e.canvas.height:n,this.fontSize=13}get lineWidth(){return this._lineWidth}set lineWidth(e){this._ctx.lineWidth=e,this._lineWidth=e}get fontSize(){return this._fontSize}set fontSize(e){this._ctx.textBaseline="alphabetic",this._ctx.font=e+"px Times New Roman",this._fontSize=e;let t=this._ctx.measureText("1ATOgjp");this.fontAscent=t.fontBoundingBoxAscent||t.actualBoundingBoxAscent,this.fontDescent=t.fontBoundingBoxDescent||t.actualBoundingBoxDescent}get fillStyle(){return this._fillColor}set fillStyle(e){this._ctx.fillStyle=e,this._fillColor=e}get strokeStyle(){return this._strokeColor}set strokeStyle(e){this._ctx.strokeStyle=e,this._strokeColor=e}measureText(e){this._ctx.textAlign="center";let t=this._ctx.measureText(e),n=(this.fontAscent+this.fontDescent)/2;return{top:n*1.3,bot:n*1,left:t.actualBoundingBoxLeft,right:t.actualBoundingBoxRight}}textNode(e,t,n,r){let a="middle",s="center";switch(r&12){case x.T:a="top";break;case x.B:a="bottom";break}switch(r&3){case x.L:s="left";break;case x.R:s="right";break}return this._ctx.textBaseline=a,this._ctx.textAlign=s,this._ctx.fillText(e,t,n),this}beginPath(){return this._ctx.beginPath(),this}moveTo(e,t){return this._ctx.moveTo(e,t),this}lineTo(e,t){return this._ctx.lineTo(e,t),this}quadraticTo(e,t,n,r){return this._ctx.quadraticCurveTo(e,t,n,r),this}cubicTo(e,t,n,r,a,s){return this._ctx.bezierCurveTo(e,t,n,r,a,s),this}closePath(){return this._ctx.closePath(),this}rect(e,t,n,r){return this._ctx.rect(e,t,n,r),this}arc(e,t,n,r,a,s){return this._ctx.arc(e,t,n,r-ae*Math.floor(se*r),a-ae*Math.floor(se*a),!s),this}stroke(){return this._ctx.stroke(),this}fill(){return this._ctx.fill(),this}fillAndStroke(){return this.fill(),this.stroke(),this}};var oe=class{constructor(e,t,...n){this.name=e;this.children=n,this.attributes=t||{}}attrString(){return Object.entries(this.attributes).map(([e,t])=>`${e}="${t}"`).join(" ")}chString(){return this.children.map(e=>e.toString()).join("")}append(e){this.children.push(e)}toString(){let e=this.name;return e===""?this.chString():`<${e} ${this.attrString()}>${this.chString()}</${e}>`}};function L(i,e,...t){return typeof i=="function"?i(e,...t):new oe(i,e,...t)}L.Fragment="";var Je=180/Math.PI,Qe=2*Math.PI,Se=.5/Math.PI,F=class{constructor(e,t){this.style={stroke:{stroke:"#000000","stroke-width":1},fill:{fill:"#000000"},fontSize:13};this.svg=L("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",viewBox:`0 0 ${e} ${t}`})}round(e){return Math.round(e*1e3)/1e3}get fillStyle(){return this.style.fill.fill}set fillStyle(e){let{fill:t}=this.style;if(e.length==9){let n=parseInt("0x"+e.slice(7,9))/255;e=e.slice(0,7),n===1?delete t["fill-opacity"]:t["fill-opacity"]=Math.round(1e3*n)/1e3}else delete t["fill-opacity"];t.fill=e}get strokeStyle(){return this.style.stroke.stroke}set strokeStyle(e){let{stroke:t}=this.style;if(e.length==9){let n=parseInt("0x"+e.slice(7,9))/255;e=e.slice(0,7),n===1?delete t["stroke-opacity"]:t["stroke-opacity"]=Math.round(1e3*n)/1e3}else delete t["stroke-opacity"];t.stroke=e}get lineWidth(){return this.style.stroke["stroke-width"]}set lineWidth(e){this.style.stroke["stroke-width"]=e}get fontSize(){return this.style.fontSize}set fontSize(e){this.style.fontSize=e}textNode(e,t,n,r=0){let a="middle",s="middle";switch(r&12){case x.T:a="hanging";break;case x.B:a="text-after-edge";break}switch(r&3){case x.L:s="start";break;case x.R:s="end";break}let o=this.round;return this.svg.append(L("text",{x:o(t),y:o(n),"font-size":this.style.fontSize,"font-family":"Times New Roman","dominant-baseline":a,"text-anchor":s},e)),this}beginPath(){return this._path=void 0,this}moveTo(e,t){let n=this.round;return this._path=(this._path||"")+`M${n(e)} ${n(t)}`,this}lineTo(e,t){if(!this._path)return this.moveTo(e,t);let n=this.round;return this._path+=`L${n(e)} ${n(t)}`,this}quadraticTo(e,t,n,r){if(!this._path)return this.moveTo(n,r);let a=this.round;return this._path+=`Q${a(e)} ${a(t)} ${a(n)} ${a(r)}`,this}cubicTo(e,t,n,r,a,s){if(!this._path)return this.moveTo(a,s);let o=this.round;return this._path+=`C${o(e)} ${o(t)} ${o(n)} ${o(r)} ${o(a)} ${o(s)}`,this}closePath(){return this._path=(this._path||"")+"Z",this}rect(e,t,n,r){return this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+r),this.lineTo(e,t+r),this.lineTo(e,t),this}arc(e,t,n,r,a,s){let o=(a-r)*Se;if(o=o-Math.floor(o),o>=.499&&o<=.511){let c=r+(s?.5*o:-.5*o);return this.arc(e,t,n,r,c,s),this.arc(e,t,n,c,a,s),this}let m=e+n*Math.cos(r),d=t+n*Math.sin(r),p=e+n*Math.cos(a),u=t+n*Math.sin(a),l=o<=.5==s,h=this.round;return this.lineTo(m,d),this._path+=`A ${h(n)} ${h(n)} 0 ${l?0:1} ${s?1:0} ${h(p)} ${h(u)}`,this}stroke(){return this._path&&this.svg.append(L("path",_({d:this._path,fill:"none"},this.style.stroke))),this}fill(){return this._path&&this.svg.append(L("path",_({d:this._path},this.style.fill))),this}fillAndStroke(){return this._path&&this.svg.append(L("path",_(_({d:this._path},this.style.fill),this.style.stroke))),this}toXML(){return`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
${this.svg.toString()}`}toFileString(){return this.toXML()}};var N=class{constructor(e,t){this.style={stroke:{color:"black",opacity:1,width:1},fill:{opacity:1,color:"black"},fontSize:13};this.width=e,this.height=t,this.TeX=`\\begin{tikzpicture}[x=1pt,y=-1pt,every node/.style={inner sep=0,outer sep=0}]%
\\fontfamily{ptm}\\selectfont%
\\useasboundingbox (0,0) rectangle (${e},${t});%
\\clip (0,0) rectangle (${e},${t});%
`}round(e){return Math.round(e*1e3)/1e3}_pathAttr(e,t){let{fill:n,stroke:r}=this.style,a;return e&&(a=`fill=${n.color}${n.opacity==1?"":",fill opacity="+n.opacity}`),t&&(a=(a?a+",":"")+`draw=${r.color},line width=${r.width}${r.opacity==1?"":",draw opacity="+r.opacity}`),a}get fillStyle(){throw new Error("not implemented")}set fillStyle(e){let{fill:t}=this.style,n=parseInt("0x"+e.substring(1));e.length===9?(t.opacity=(n&255)/255,n>>=8):t.opacity=1;let r=255&n,a=255&n>>8,s=255&n>>16;s==0&&a==0&&r==0?t.color="black":t.color=`{rgb,255:red,${s}; green,${a}; blue,${r}}`}get strokeStyle(){throw new Error("Not Implemented")}set strokeStyle(e){let{stroke:t}=this.style,n=parseInt("0x"+e.substring(1));e.length===9?(t.opacity=(n&255)/255,n>>=8):t.opacity=1;let r=255&n,a=255&n>>8,s=255&n>>16;s==0&&a==0&&r==0?t.color="black":t.color=`{rgb,255:red,${s}; green,${a}; blue,${r}}`}get lineWidth(){throw new Error("Not Implemented")}set lineWidth(e){this.style.stroke.width=e}get fontSize(){return this.style.fontSize}set fontSize(e){this.style.fontSize=e}textNode(e,t,n,r=0){let a;switch(r&12){case x.T:a="north";break;case x.B:a="south";break}switch(r&3){case x.L:a=(a?a+" ":"")+"west";break;case x.R:a=(a?a+" ":"")+"east";break}a=a||"center";let s=this.round;return this.TeX+=`\\node at(${s(t)},${s(n)}) [anchor=${a}]{\\fontsize{${this.style.fontSize}pt}{${this.style.fontSize}pt}\\selectfont\\vphantom{Og}${e.replace("\\","\\textbackslash{}")}};`,this}beginPath(){return this.path=void 0,this.pos=void 0,this}moveTo(e,t){let n=this.round;return this.path=(this.path||"")+` (${n(e)},${n(t)})`,this.pos=[e,t],this}lineTo(e,t){if(!this.path)return this.moveTo(e,t);let n=this.round;return this.path+=` -- (${n(e)},${n(t)})`,this.pos=[e,t],this}quadraticTo(e,t,n,r){if(!this.path)return this.moveTo(n,r);let[a,s]=this.pos;return this.cubicTo(a+2/3*(e-a),s+2/3*(t-s),n+2/3*(e-n),r+2/3*(t-r),n,r)}cubicTo(e,t,n,r,a,s){if(!this.path)return this.moveTo(a,s);let o=this.round;return this.path+=` .. controls (${o(e)},${o(t)}) and (${o(n)},${o(r)}) .. (${o(a)},${o(s)})`,this.pos=[a,s],this}closePath(){return this.path+=" -- cycle",this}rect(e,t,n,r){return this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+r),this.lineTo(e,t+r),this.lineTo(e,t),this}arc(e,t,n,r,a,s){let o=e+n*Math.cos(r),m=t+n*Math.sin(r),d=e+n*Math.cos(a),p=t+n*Math.sin(a);r/=2*Math.PI,a/=2*Math.PI,r-=Math.floor(r),a-=Math.floor(a),s&&a<r&&(a+=1),!s&&r<a&&(a-=1),this.lineTo(o,m);let u=this.round;return this.path+=` arc(${u(r*360)}:${u(a*360)}:${u(n)})`,this.pos=[d,p],this}stroke(){let e=`\\path [${this._pathAttr(!1,!0)}]${this.path};%
`;return this.TeX+=e,this}fill(){let e=`\\path [${this._pathAttr(!0,!1)}]${this.path};%
`;return this.TeX+=e,this}fillAndStroke(){let e=`\\path [${this._pathAttr(!0,!0)}]${this.path};%
`;return this.TeX+=e,this}toTeX(){return this.TeX+"\\end{tikzpicture}"}toFileString(){return this.toTeX()}};var x;(function(d){d[d.C=0]="C",d[d.T=8]="T",d[d.L=2]="L",d[d.R=1]="R",d[d.B=4]="B",d[d.TL=10]="TL",d[d.TR=9]="TR",d[d.BL=6]="BL",d[d.BR=5]="BR"})(x||(x={}));var A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",le=[..."\u{1D538}\u{1D539}\u2102\u{1D53B}\u{1D53C}\u{1D53D}\u{1D53E}\u210D\u{1D540}\u{1D541}\u{1D542}\u{1D543}\u{1D544}\u2115\u{1D546}\u2119\u211A\u211D\u{1D54A}\u{1D54B}\u{1D54C}\u{1D54D}\u{1D54E}\u{1D54F}\u{1D550}\u2124\u{1D552}\u{1D553}\u{1D554}\u{1D555}\u{1D556}\u{1D557}\u{1D558}\u{1D559}\u{1D55A}\u{1D55B}\u{1D55C}\u{1D55D}\u{1D55E}\u{1D55F}\u{1D560}\u{1D561}\u{1D562}\u{1D563}\u{1D564}\u{1D565}\u{1D566}\u{1D567}\u{1D568}\u{1D569}\u{1D56A}\u{1D56B}\u{1D7D8}\u{1D7D9}\u{1D7DA}\u{1D7DB}\u{1D7DC}\u{1D7DD}\u{1D7DE}\u{1D7DF}\u{1D7E0}\u{1D7E1}"],ue=[..."\u{1D56C}\u{1D56D}\u{1D56E}\u{1D56F}\u{1D570}\u{1D571}\u{1D572}\u{1D573}\u{1D574}\u{1D575}\u{1D576}\u{1D577}\u{1D578}\u{1D579}\u{1D57A}\u{1D57B}\u{1D57C}\u{1D57D}\u{1D57E}\u{1D57F}\u{1D580}\u{1D581}\u{1D582}\u{1D583}\u{1D584}\u{1D585}\u{1D586}\u{1D587}\u{1D588}\u{1D589}\u{1D58A}\u{1D58B}\u{1D58C}\u{1D58D}\u{1D58E}\u{1D58F}\u{1D590}\u{1D591}\u{1D592}\u{1D593}\u{1D594}\u{1D595}\u{1D596}\u{1D597}\u{1D598}\u{1D599}\u{1D59A}\u{1D59B}\u{1D59C}\u{1D59D}\u{1D59E}\u{1D59F}"],X={Alpha:"\u0391",alpha:"\u03B1",Beta:"\u0392",beta:"\u03B2",Gamma:"\u0393",gamma:"\u03B3",Delta:"\u0394",delta:"\u03B4",Epsilon:"\u0395",epsilon:"\u03B5",Zeta:"\u0396",zeta:"\u03B6",Eta:"\u0397",eta:"\u03B7",Theta:"\u0398",theta:"\u03B8",Iota:"\u0399",iota:"\u03B9",Kappa:"\u039A",kappa:"\u03BA",Lambda:"\u039B",lambda:"\u03BB",Mu:"\u039C",mu:"\u03BC",Nu:"\u039D",nu:"\u03BD",Xi:"\u039E",xi:"\u03BE",Omicron:"\u039F",omicron:"\u03BF",Pi:"\u03A0",pi:"\u03C0",Rho:"\u03A1",rho:"\u03C1",Sigma:"\u03A3",sigma:"\u03C3",Tau:"\u03A4",tau:"\u03C4",Upsilon:"\u03A5",upsilon:"\u03C5",Phi:"\u03A6",phi:"\u03C6",Chi:"\u03A7",chi:"\u03C7",Psi:"\u03A8",psi:"\u03C8",Omega:"\u03A9",omega:"\u03C9",mathBB:function(i){if(i.length==1){let e=A.indexOf(i);return le[e]}else{let e="";for(let t=0;t<i.length;t++)e=e+le[A.indexOf(i.charAt(t))];return e}},mathFrak:function(i){if(i.length==1){let e=A.indexOf(i);return ue[e]}else{let e="";for(let t=0;t<i.length;t++)e=e+ue[A.indexOf(i.charAt(t))];return e}}};var G=class{constructor(e,t){this.origin=e;this.scale=t}project(e){return Array.isArray(e)&&(e=new v(e[0],e[1])),[e.real*this.scale+this.origin[0],-e.imag*this.scale+this.origin[1]]}invert(e){return new v((e[0]-this.origin[0])/this.scale,-(e[1]-this.origin[1])/this.scale)}addTranslation(e){this.origin=[this.origin[0]+e[0],this.origin[1]+e[1]]}addZoom(e,t){let[n,r]=this.origin;this.origin=[n*e+t[0]*(1-e),r*e+t[1]*(1-e)],this.scale*=e}};function me(i,e,t,n,r,{arrowSize:a=9}={}){let s=Math.sqrt(r[0]*r[0]+r[1]*r[1]);r=[r[0]/s,r[1]/s];let o=[r[0]===0?-1/0:(0-n[0])/r[0],r[0]===0?1/0:(e-n[0])/r[0],r[1]===0?-1/0:(0-n[1])/r[1],r[1]===0?1/0:(t-n[1])/r[1]].sort((u,l)=>u-l),m=[n[0]+o[1]*r[0],n[1]+o[1]*r[1]],d=[n[0]+(o[2]-1)*r[0],n[1]+(o[2]-1)*r[1]];i.beginPath(),i.moveTo(m[0],m[1]),i.lineTo(d[0]-2*r[0],d[1]-2*r[1]),i.stroke();let p=a;return i.beginPath(),i.moveTo(d[0],d[1]),i.lineTo(d[0]-p*r[0]+.5*p*r[1],d[1]-p*r[1]-.5*p*r[0]),i.lineTo(d[0]-p*r[0]-.5*p*r[1],d[1]-p*r[1]+.5*p*r[0]),i.lineTo(d[0],d[1]),i.fill(),[m[0],m[1],d[0],d[1]]}function de(i,e,{noX:t=!1,noY:n=!1,arrowSize:r=7,fontSize:a=13,labelX:s=X.mathBB("R"),labelY:o="i"+X.mathBB("R")}={}){let{origin:m,scale:d}=e,{width:p,height:u}=i;i.fontSize=a;let l=function(g,w=0){let{ps:M,ox:B,oy:C}=this;return[g*M+B,-w*M+C]}.bind({ox:m[0],oy:m[1],ps:d}),h=l(1),c=l(0,1),f=[h[0]-m[0],h[1]-m[1]],b=[c[0]-m[0],c[1]-m[1]];if(!t){let[,,g,w]=me(i,p,u,m,f,{arrowSize:r});s&&i.textNode(s,g-.2*a,w+.2*a+r/2,x.TR)}if(!n){let[,,g,w]=me(i,p,u,m,b,{arrowSize:r});!n&&o&&i.textNode(o,g-.2*a-r/2,w+.2*a,x.TR)}}function he(i,e,{origin:t,scale:n},r,{gap:a=5}={}){var s=i.width||0,o=i.height||0;if(e=="x"){let m=t[0],d=t[1];for(let p=0;p<r.length;p++){let{at:u,sprite:l}=r[p],h=u*n+m;if(h+l.right>=0&&h-l.left<=s){let c=d,f=h-.5,b=h+.5,g=d+3;i.beginPath().moveTo(f,c).lineTo(b,c).lineTo(b,g).lineTo(f,g).closePath(),i.fill(),l.draw(i,h,d+l.top+a)}}}}function k(i,e,t){let{center:n=!1}=t||{},{top:r,bot:a,left:s,right:o}=i.measureText(e),m=0;return n&&(m=(o-s)/2,s+=m,o-=m),{text:e,dx:m,top:r,bot:a,left:s,right:o,draw:function(p,u,l){p.textNode(this.text,u-this.dx,l,0)}}}function Y(i,e){let t=.05*(i.top+i.bot+e.top+e.bot),n=.5*(i.left-i.right),r=.5*(e.left-e.right),a=-i.bot-t,s=e.top+t,o=Math.max(.5*(i.left+i.right),.5*(e.left+e.right));return{data:[n,a,r,s,o],top:-a+i.top,bot:s+e.bot,left:o,right:o,draw:function(d,p,u){let[l,h,c,f,b]=this.data;i.draw(d,p+l,u+h),e.draw(d,p+c,u+f),d.beginPath(),d.moveTo(p-b,u),d.lineTo(p+b,u),d.stroke()}}}var K=class{constructor(e,t,n){this.onDrag=e;this.onZoom=t;this.onHover=n;this.state=new Array;this.down=e=>{if(e.pointerType=="mouse"&&e.button!=0)return;let{pointerId:t,offsetX:n,offsetY:r}=e,a=this.state.find(({id:s})=>s===t);a===void 0&&(a={id:t,x:n,y:r},this.state.push(a)),this.state.length<=1?this.onHover([n,r]):this.onHover(null),e.currentTarget.setPointerCapture(t)};this.move=e=>{let{pointerId:t,offsetX:n,offsetY:r}=e;if(this.state.length===0){this.onHover([n,r]);return}let a=this.state.findIndex(({id:o})=>o===t);if(a===-1)return;let s=this.state[a];if(this.state.length===1)this.onHover([n,r]),this.onDrag([n-s.x,r-s.y]);else if(this.state.length===2){let o=s,m=this.state[1-a],d=$(o.x-m.x,2)+$(o.y-m.y,2),p=$(n-m.x,2)+$(r-m.y,2),u=[.5*(n-o.x),.5*(r-o.y)];this.onHover(null),this.onDrag(u),this.onZoom(p/d,[.5*(n+m.x),.5*(r+m.y)])}s.x=n,s.y=r};this.up=e=>{if(e.pointerType=="mouse"&&e.button!=0)return;let{pointerId:t,offsetX:n,offsetY:r}=e,a=this.state.findIndex(({id:s})=>s===t);this.state.splice(a,1),e.currentTarget.releasePointerCapture(t)};this.cancel=e=>{if(e.pointerType=="mouse"&&e.button!=0)return;let{pointerId:t,offsetX:n,offsetY:r}=e,a=this.state.findIndex(({id:s})=>s===t);this.state.splice(a,1),e.currentTarget.releasePointerCapture(t)};this.leave=e=>{if(e.pointerType=="mouse"&&e.button!=0||e.currentTarget.hasPointerCapture(e.pointerId))return;let{pointerId:t,offsetX:n,offsetY:r}=e,a=this.state.findIndex(({id:s})=>s===t);this.state.splice(a,1),e.currentTarget.releasePointerCapture(t)};this.wheel=e=>{e.preventDefault(),this.onZoom(Math.exp(-e.deltaY*(e.deltaMode==1?.03333:.001)),[e.offsetX,e.offsetY])}}registerListeners(e){e.addEventListener("pointerup",this.up),e.addEventListener("pointerdown",this.down),e.addEventListener("pointermove",this.move),e.addEventListener("pointercancel",this.cancel),e.addEventListener("pointerleave",this.leave),e.addEventListener("wheel",this.wheel)}removeListeres(e){e.removeEventListener("pointerup",this.up),e.removeEventListener("pointerdown",this.down),e.removeEventListener("pointermove",this.move),e.removeEventListener("pointercancel",this.cancel),e.removeEventListener("wheel",this.wheel)}};function z(i,e=[],t={},n={}){let r=document.createElement(i);for(let[s,o]of Object.entries(t))r.setAttribute(s,typeof o=="string"?o:o+"");for(let[s,o]of Object.entries(n))r[s]=o;if(Array.isArray(e))for(var a of e)typeof a=="string"&&(a=document.createTextNode(a)),r.append(a);else r.innerHTML=e.__html;return r}function W(i,e){for(var t of e)Array.isArray(t)?W(i,t):i.append(t instanceof Node?t:""+t)}function y(i,e,...t){if(i===y.Fragment){let s=document.createDocumentFragment();return W(s,t),s}let n=document.createElement(i);e=e||{},"__html"in e&&(n.innerHTML=""+e.__html,delete e.__html);for(var[r,a]of Object.entries(e))typeof a=="function"?n[r]=a:n.setAttribute(r,""+a);return W(n,t),n}y.Fragment="";var Le=`:host{position:relative;top:0;left:0;display:block;width:100%;height:100%;overflow:hidden;padding:0;margin:0}._container_1kdby_13{display:block;position:absolute;width:100%;height:100%;touch-action:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}._container_1kdby_13>div,._container_1kdby_13>canvas{position:absolute;top:0;left:0;width:100%;height:100%}
`,Pe={container:"_container_1kdby_13"},q={css:Le,class:Pe};function U(i){return{update(e,t){let n=t.getContext("2d"),r=window.devicePixelRatio;(Math.floor(e.width*r)!==t.width||Math.floor(e.height*r)!==t.height)&&(t.width=Math.floor(e.width*r),t.height=Math.floor(e.height*r)),n.setTransform(r,0,0,r,0,0),i.update(e,n)},resized(e){e.update(this)},connected(e){return{nodes:z("canvas",[],{class:"canvas-layer"})}}}}var Oe=`._button_1aydv_1{position:absolute;bottom:1em;right:1em;width:50px;height:50px;padding:10px;border-radius:50%;border:2px solid #012;background-color:#012;color:#def;z-index:99}._button_1aydv_1:hover{background-color:#bbddee;color:#001122}._button_1aydv_1:active{transform:translateY(1px);background-color:#bbddee;color:#001122}._icon_1aydv_25{display:block;width:100%;height:100%}.active ._icon_1aydv_25{display:none}._icon_x_1aydv_35{display:none;width:100%;height:100%}.active ._icon_x_1aydv_35{display:block}._container_1aydv_45{display:none;position:absolute;overflow:scroll;top:0;right:0;width:100%;height:100%;background-color:#eeeeeeaa;margin:0;padding:20px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;z-index:99}._list_1aydv_63{display:grid;display:block;grid-template-columns:repeat(auto-fill,250px);margin:auto}dialog::backdrop{background:rgba(0,0,0,0.9)}
`,Ee={button:"_button_1aydv_1",icon:"_icon_1aydv_25",icon_x:"_icon_x_1aydv_35",container:"_container_1aydv_45",list:"_list_1aydv_63"},P={css:Oe,class:Ee};var $e={section:function(i,e){var t;return{input:y((t=e==null?void 0:e.level)!=null?t:"h2",{},i)}},number:function(i){let e=i.onChange;return{label:y("label",null,i.label),input:y("input",_({type:"number",oninput:t=>{e==null||e(parseInt(t.target.value))}},i.default?{value:i.default}:{}))}},color:function(i){let e=i.onChange;return{label:y("label",null,i.label),input:y("input",_({type:"color",oninput:t=>{e==null||e(t.target.value)}},i.default?{value:i.default}:{}))}},radio:function(i){let e=i.onChange;return{label:y("label",null,i.label),input:y(y.Fragment,null,i.values.map(t=>y(y.Fragment,null,y("label",null,t.label,y("input",_({type:"radio",name:i.label,value:t.name,oninput:n=>{e==null||e(n.target.value)}},t.name===i.default?{checked:""}:{}))),y("span",{style:"display:inline-block;width:1em;"}))))}},multiButton:function(i){let e=i.onClick;return{label:y("label",null,i.label),input:y(y.Fragment,null,i.values.map(t=>y("button",{value:t.name,onclick:n=>{e==null||e(n.target.value)}},t.label)))}},custom:function(i){return{label:typeof i.label=="string"?y("span",null,i.label):i.label,input:i.input}}};function J(){return i=>{let e=y("div",{class:P.class.container},y("h1",null,"Options")),t=y("button",{"arial-label":"Options Toggle",class:P.class.button,title:"Show all options",__html:`<svg xmlns="http://www.w3.org/2000/svg" class="${P.class.icon}" viewBox="0 0 24 24" style="fill:currentColor;"><path d="M19.9,13.3C20,12.8,20,12.4,20,12s0-0.8-0.1-1.3L21.8,9l-2.3-4l-2.4,0.8c-0.7-0.5-1.4-1-2.2-1.3L14.3,2H9.7L9.2,4.5	C8.3,4.8,7.6,5.3,6.9,5.8L4.5,5L2.2,9l1.9,1.7C4,11.2,4,11.6,4,12c0,0.4,0,0.8,0.1,1.3L2.2,15l2.3,4l2.4-0.8l0,0	c0.7,0.5,1.4,1,2.2,1.3L9.7,22h4.7l0.5-2.5c0.8-0.3,1.6-0.7,2.2-1.3l0,0l2.4,0.8l2.3-4L19.9,13.3L19.9,13.3z M12,16	c-2.2,0-4-1.8-4-4c0-2.2,1.8-4,4-4c2.2,0,4,1.8,4,4C16,14.2,14.2,16,12,16z"></path></svg><svg class="${P.class.icon_x}" version="1.1" viewBox="0 0 460.78 460.78" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="m285.08 230.4 171.14-171.13c6.076-6.077 6.076-15.911 0-21.986l-32.707-32.719c-2.913-2.911-6.866-4.55-10.992-4.55-4.127 0-8.08 1.639-10.993 4.55l-171.14 171.14-171.14-171.14c-2.913-2.911-6.866-4.55-10.993-4.55-4.126 0-8.08 1.639-10.992 4.55l-32.707 32.719c-6.077 6.075-6.077 15.909 0 21.986l171.14 171.13-171.12 171.11c-6.074 6.077-6.074 15.911 0 21.986l32.709 32.719c2.911 2.911 6.865 4.55 10.992 4.55s8.08-1.639 10.994-4.55l171.12-171.12 171.12 171.12c2.913 2.911 6.866 4.55 10.993 4.55 4.128 0 8.081-1.639 10.992-4.55l32.709-32.719c6.074-6.075 6.074-15.909 0-21.986l-171.12-171.11z"/></svg>`,onclick:()=>{let r=e.style.display=="block";e.style.display=r?"":"block",r?t.classList.remove("active"):t.classList.add("active")}}),n=new ce;return n.container.className=P.class.list,e.append(n.container),i.attachToShaddow(y("style",{__html:P.css}),e,t),{nodes:void 0,handle:n}}}function pe(i){let e=y("input",{type:"number",style:"width:6em;"}),t=y("input",{type:"number",style:"width:6em;"}),n=y("span",null,"auto sizing"),r=new ResizeObserver(()=>{if(i.containerElement.style.width==="")return;let p=i.hostElement;if(!p)return;let{clientWidth:u,clientHeight:l}=i.containerElement,{clientWidth:h,clientHeight:c}=p,f=Math.min(h/u,c/l);i.containerElement.style.transformOrigin="top left",i.containerElement.style.transform=`translate(${(h-u*f)/2}px, ${(c-l*f)/2}px) scale(${f}, ${f})`}),a=!1,s=(p,u)=>{let l=p<0||u<0||isNaN(p)||isNaN(u);l&&a&&(r.unobserve(i.containerElement),r.unobserve(i.hostElement),a=!1),!a&&!l&&(r.observe(i.containerElement),r.observe(i.hostElement),a=!0),l?(i.containerElement.style.width="",i.containerElement.style.height="",i.containerElement.style.outline="",i.containerElement.style.transform="",i.containerElement.style.transformOrigin="",n.textContent="auto sizing"):(i.containerElement.style.width=p+"px",i.containerElement.style.height=u+"px",i.containerElement.style.outline="1px dashed black",n.textContent=p+" x "+u),o.close()},o=y("dialog",null,y("form",{onsubmit:()=>(s(parseInt(e.value),parseInt(t.value)),!1)},y("p",null,"Choose new size:"),e," x ",t,y("br",null),y("input",{type:"submit",value:"Apply"}),y("input",{type:"button",value:"Reset",onclick:()=>{s(-1,-1)}}))),m,d;return m=y("span",null,y("input",{type:"button",value:"Change",onclick:()=>{o.showModal()}}),o),{label:y("span",null,"Canvas size (",n,")"),input:m}}var ce=class{constructor(){this.container=y("div",null)}add(e,...t){Array.isArray(e)&&(t=e.slice(1),e=e[0]);var r=(typeof e=="function"?e:$e[e])(...t);if(console.log(r),this.addOption(r),"handle"in r)return r.handle}addOption(e){this.container.appendChild(y("div",{style:"margin-top: 10px;"},e.label?y("div",null,y("b",null,e.label,":")):[],y("div",null,e.input)))}};var fe=class extends HTMLElement{constructor(){super(...arguments);this.shadow=this.attachShadow({mode:"open"});this.cleanup=[]}connectedCallback(){var d,p;let e=this.shadow;e.innerHTML="";let t=z("style",[q.css]),n=z("div",[],{class:q.class.container}),r=new ResizeObserver(()=>{var l,h,c,f;(h=(l=this.layerHandler).resized)==null||h.call(l,m);for(var u of a.values())(f=(c=u.layer)==null?void 0:c.resized)==null||f.call(c,m,u.nodes)});r.observe(n),e.append(t,n);let a=new Map,s=0,o=()=>{var h,c;let u=s===2;s=0;for(var l of a.values())(u||l.update)&&((c=(h=l.layer)==null?void 0:h.update)==null||c.call(h,m,l.nodes)),l.update=!1},m={get width(){return n.clientWidth},get height(){return n.clientHeight},containerElement:n,hostElement:this,update:function(u){if(s!==2){if(s===0&&requestAnimationFrame(o),u===void 0){s=2;return}if(typeof u=="string"){s=1;let h=a.get(u);h&&(h.update=!0);return}for(var l of a.values())u===l.layer&&(l.update=!0)}},addStyles:function(u){t.append(u)},addLayer:function(u,l){if(l instanceof Node){n.appendChild(l);return}let h,c;typeof l=="function"?(c=l(m),h=void 0):(c=l.connected(m),h=l);let f=c.nodes;f&&(Array.isArray(f)?n.append(...f):n.append(f)),a.set(u,{nodes:f,layer:h,update:!1}),m.update(u);let b=c.handle;return b||(b={}),b.update=()=>{this.update(u)},b},attachToShaddow(...u){e.append(...u)}};(p=(d=this.layerHandler).connected)==null||p.call(d,m),this.cleanup.push(()=>{var l,h,c,f;r.unobserve(n);for(var u of a.values())(h=(l=u.layer)==null?void 0:l.disconnected)==null||h.call(l,m);(f=(c=this.layerHandler).disconnected)==null||f.call(c,m)})}disconnectedCallback(){for(var e of this.cleanup)e();this.cleanup=[],this.shadow.innerHTML=""}};function be(i){return class extends fe{constructor(){super(...arguments);this.layerHandler=i}}}function Ie(i,e,t="text/plain"){let n=`data:${t};base64,${window.btoa(i)}`,r=document.createElement("a");r.setAttribute("download",e),r.href=n,r.click()}var ye=I.async(function*(i,e,t){let n=new S(document.createElement("canvas").getContext("2d")),{projection:r}=t,{origin:a,scale:s}=r;i.fillStyle="#AAAAAA",i.beginPath(),i.arc(...a,s,0,2*Math.PI-.01,!0),i.fillAndStroke();let o=ve(e),m=12;i.fontSize=m;let d=e,p=Array(d).fill(null).map(()=>[]);i.fillStyle="#FFFFFF";for(let[u,l]of o){yield;let h=10;if(u==0)continue;l===1&&(h=40);let c=u/l,f=.5/l/l,b=Re(i,[c,f],f,r,h);i.fillAndStroke(),l<=d&&p[l-1].push([u,b[0],b[1]])}i.fillStyle="#555555";for(let u=0;u<p.length;u++){let l=u+1;i.fontSize=l==1?s/2:s/l/l,n.fontSize=l==1?s/2:s/l/l;let h;for(let[c,f,b]of p[u]){if(l==1){k(n,""+c).draw(i,f,b);continue}h!=null||(h=k(n,""+l)),Y(k(n,""+c),h).draw(i,f,b)}}}),ge=I.async(function*(i,e,t){let n=new S(document.createElement("canvas").getContext("2d"));i.fillStyle="#AAAAAA";let{width:r,height:a}=i;i.moveTo(0,0).lineTo(0,a).lineTo(r,a).lineTo(r,0).closePath().fill(),i.fillStyle="#000000";let{projection:s}=t,{origin:o,scale:m}=s,d=12;i.fontSize=d;let p=e,u=Array(p).fill(null).map(()=>[]);i.lineWidth=1.25,i.fontSize=10,de(i,s,{noY:!0,labelX:""}),he(i,"x",s,[{sprite:k(n,"0"),at:0},{sprite:k(n,"1"),at:1}]);let l=ve(e);function h(f,b){return[f*m+o[0],-b*m+o[1]]}i.fillStyle="#FFFFFF";for(let[f,b]of l){yield;let g=f/b,w=.5/b/b;i.beginPath(),i.arc(...h(g,w),w*m,0,2*Math.PI-.01,!0),i.closePath(),i.stroke(),i.fill(),b<p&&u[b-1].push(f)}let c=0;i.fillStyle="#000000";for(let f=0;f<u.length;f++){let b=f+1;i.fontSize=m*.3/b/b,n.fontSize=m*.3/b/b;let g;for(let w of u[f]){yield;let M=h(w/b,0)[0];M<-2*d||M>r+2*d||(c++,g!=null||(g=k(n,""+b)),Y(k(n,""+w),g).draw(i,...h(w/b,.5/b/b)))}}});function Re(i,e,t,n,r=20){let{origin:a=[0,0],scale:s=1}=n||{};function o(l,h){let c=Math.exp(-2*Math.PI*h);return[Math.cos(2*Math.PI*l)*c*s+a[0],-Math.sin(2*Math.PI*l)*c*s+a[1]]}let m=2*Math.PI/r,d=0,p=[0,0];i.beginPath();let u=o(e[0]+t,e[1]);i.moveTo(...u);for(let l=1;l<r+1;l++){let h=o(e[0]+Math.cos(m*l)*t,e[1]+Math.sin(m*l)*t),c=o(e[0]+Math.cos(m*(l-.5))*t,e[1]+Math.sin(m*(l-.5))*t),f=Math.sqrt((h[0]-u[0])*(h[0]-u[0])+(h[1]-u[1])*(h[1]-u[1]));d+=f,p[0]+=f*c[0],p[1]+=f*c[1],i.quadraticTo(2*c[0]-.5*(u[0]+h[0]),2*c[1]-.5*(u[1]+h[1]),...h),u=h}return i.closePath(),[p[0]/d,p[1]/d]}window.customElements.define("ford-circles",be({connected(i){let e=new D,t=new G([i.width/2,i.height/2],100);new K(o=>{t.addTranslation(o),i.update()},(o,m)=>{let d=t.project(new v(0)),p=t.project(new v(1)),u=Math.abs(d[0]-p[0]);o<=.1*i.width/u&&(o=.1*i.width/u),t.addZoom(o,m),i.update()},()=>{}).registerListeners(i.containerElement);let r=i.addLayer("Options",J()),a=30,s="Halfplane";r.add("number",{label:"Circles up to denominator",onChange(o){a=o>1?o:1,i.update()},default:a}),r.add("radio",{label:"Show in:",values:[{name:"Halfplane",label:"Upper halfplane"},{name:"Cirlce",label:"Unit circle"}],default:s,onChange(o){s=o,i.update()}}),r.add(pe,i),r.add("multiButton",{label:"Export as",values:[{name:"SVG",label:"SVG"},{name:"TikZ",label:"TikZ"}],onClick(o){return O(this,null,function*(){let m,d="Hyperbola",p;if(o=="SVG")m=new F(i.width,i.height),d+=".svg",p="image/svg+xml";else if(o=="TikZ")m=new N(i.width,i.height),d+=".tikz",p="text/plain";else throw new Error("Unknown format");let u;s=="Halfplane"?u=ge(m,a,{projection:t}):u=ye(m,a,{projection:t}),u.catch(l=>console.log(l)),yield u,Ie(m.toFileString(),d,p)})}}),i.addLayer("draw",U({update(o,m){let d=new S(m);m.clearRect(0,0,o.width,o.height),e.abortAll("draw"),s==="Halfplane"?ge(d,a,{projection:t},e.getNew("draw",100)).catch(p=>{p!=="aborted"&&console.log(p)}):ye(d,a,{projection:t},e.getNew("draw",100)).catch(p=>{p!=="aborted"&&console.log(p)})}}))}}));function ve(i){return{[Symbol.iterator]:function*(e){let[t,n,r,a]=e!=null?e:[0,1,1,i];for(yield[t,n],yield[r,a];a!==1;){let s=Math.floor((i+n)/a);[t,n,r,a]=[r,a,s*r-t,s*a-n],yield[r,a]}},approximate(e){let t=Math.floor(e);e=e-t;let n=0,r=1,a=1,s=1;for(;;){let o=a-e*s,m;o!=0&&(m=Math.floor((e*r-n)/o)),(m===void 0||r+m*s>i)&&(m=Math.floor((i-r)/s)),n=n+m*a,r=r+m*s,o=r*e-n;let d;if(o!=0&&(d=Math.floor((a-e*s)/o)),(d===void 0||r*d+s>i)&&(d=Math.floor((i-s)/r)),a=n*d+a,s=r*d+s,m==0&&d==0)break}return[n,r,a,s]},startAt(e){return this.continue(...this.approximate(e))},continue(e,t,n,r){if(t*n-e*r!=1||t+r<=i)throw`${e}/${t} and ${n}/${r} are not consecutive`;return this[Symbol.iterator]([e,t,n,r])}}}})();
</script><ford-circles ><div style="display:grid;justify-items:center;align-items:center;width:100%;height:100%;"><h2 >Javascript required!</h2></div></ford-circles>
          
        </main>
      
    </div>
  </body>
</html>