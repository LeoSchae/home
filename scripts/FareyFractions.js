(()=>{var L=Math.pow;var N=(s,e,t)=>new Promise((n,r)=>{var i=u=>{try{l(t.next(u))}catch(o){r(o)}},a=u=>{try{l(t.throw(u))}catch(o){r(o)}},l=u=>u.done?n(u.value):Promise.resolve(u.value).then(i,a);l((t=t.apply(s,e)).next())});function W(s,e,t,n){return N(this,null,function*(){var l,u;n!=null||(n=ge);let r=n.create();(l=r.begin)==null||l.call(r);let i=e.apply(s,t),a=i.next();for(;!a.done;)r.shouldYield()&&(yield r.yield()),a=i.next();return(u=r.done)==null||u.call(r),a.value})}function Y(s,e,t){let n=e.apply(s,t),r=n.next();for(;!r.done;)r=n.next();return r.value}var ge={create:()=>({shouldYield(){return!1},yield(){return N(this,null,function*(){})}})};function Z(s){let e=s[s.length-1],t;return"create"in e&&(s=Array.prototype.slice.call(s,0,s.length-1),t=e),[t,s]}var V;(function(t){function s(n){return function(...i){let[a,l]=Z(i);return W(this,n,l,a)}}t.async=s;function e(n){return function(...i){return Y(this,n,i)}}t.sync=e})(V||(V={}));var M;(function(t){function s(n){return function(...i){let[a,l]=Z(i);return W(this,this[n],l,a)}}t.async=s;function e(n){return function(...i){return Y(this,this[n],i)}}t.sync=e})(M||(M={}));var C;(function(n){n.Infinity="infinity",n.Complex="complex",n.Moebius="moebius"})(C||(C={}));var R={mathtype:C.Infinity},ve=class{constructor(e,t,n=1){this.start=e;this.end=t;this.step=n}*[Symbol.iterator](){let{start:e,step:t,end:n}=this;for(;e<n;)yield e,e+=t}};function ke(s,e){return typeof s=="number"?new g(s,e):Array.isArray(s)?new g(s[0],s[1]):s}var g=class{constructor(e,t=0){this.mathtype=C.Complex;this.real=e,this.imag=t}abs2(){return this.real*this.real+this.imag*this.imag}abs(){return Math.sqrt(this.abs2())}add(e){return typeof e=="number"?new g(this.real+e,this.imag):new g(this.real+e.real,this.imag+e.imag)}sub(e){return typeof e=="number"?new g(this.real-e,this.imag):new g(this.real-e.real,this.imag-e.imag)}mul(e){return typeof e=="number"?new g(e*this.real,e*this.imag):new g(this.real*e.real-this.imag*e.imag,this.imag*e.real+this.real*e.imag)}div(e){return typeof e=="number"?new g(this.real/e,this.imag/e):this.mul(e.inv())}inv(){var e=this.abs2();return new g(this.real/e,-this.imag/e)}arg(){var e=this.real,t=this.imag;if(e==0)return t>0?.5*Math.PI:t<0?1.5*Math.PI:0;if(e>=0){let n=Math.atan(1*t/e);return n<0?2*Math.PI+n:n}return Math.atan(1*t/e)+Math.PI}toTeX(){return this.imag==0?`${this.real}`:this.real==0?`${this.imag}i`:`${this.real} + ${this.imag}i`}},k=class{constructor(e,t,n,r){this.mathtype=C.Moebius;this.m=[e,t,n,r]}mul(e){let t=this.m,n=e.m;return new k(t[0]*n[0]+t[1]*n[2],t[0]*n[1]+t[1]*n[3],t[2]*n[0]+t[3]*n[2],t[2]*n[1]+t[3]*n[3])}inv(){let e=this.m;return new k(e[3],-e[1],-e[2],e[0])}transform(e,t){if(typeof e=="number")e=ke(e,t);else if(e.mathtype===C.Infinity)return this.m[2]==0?R:new g(this.m[0]/this.m[2]);let n=this.m,r=e.mul(n[2]).add(n[3]);return r.real==0&&r.imag==0?R:e.mul(n[0]).add(n[1]).div(r)}toTeX(){return`\\begin{pmatrix}${this.m[0]}&${this.m[1]}\\\\ ${this.m[2]}&${this.m[3]}\\end{pmatrix}`}},J;(function(c){class s{constructor(m,d){this.cosetRepresentatives=M.sync("_cosetRepresentatives");this.cosetRepresentativesAsync=M.async("_cosetRepresentatives");this.indicator=m,this.tex=d}findCosetIndex(m,d,p){let f=p.inv(),y=this.indicator;for(var v=0;v<d.length;v++)if(y(m,d[v].mul(f)))return v;return-1}findCoset(m,d,p){let f=p.inv(),y=this.indicator;return d.find(v=>y(m,v.mul(f)))}*_cosetRepresentatives(m){if(!Number.isInteger(m)||m<=0)throw"Invalid Level";let d=[new k(0,-1,1,0),new k(1,1,0,1),new k(1,-1,0,1)],p=this,f=[new k(1,0,0,1)];for(var y=[],v=[],w=[new k(1,0,0,1)];w.length>0;){y=v,v=w,w=[];for(let T of v)for(let _ of d){yield;let x=T.mul(_);p.findCosetIndex(m,y,x)==-1&&p.findCosetIndex(m,w,x)==-1&&p.findCosetIndex(m,v,x)==-1&&(f.push(x),w.push(x))}}return f}toTeX(){return this.tex}}c.CongruenceSubgroup=s;function e(h,m,d){return(h-m)%d==0}function t(h,m){return e(m.m[2],0,h)}c.Gamma_0=new s(t,"\\Gamma_0");function r(h,m){return e(m.m[2],0,h)&&(e(m.m[0],1,h)||e(m.m[0],-1,h))}c.Gamma_1=new s(r,"\\Gamma_1");function a(h,m){return e(m.m[2],0,h)&&e(m.m[1],0,h)&&(e(m.m[0],1,h)||e(m.m[0],-1,h))}c.Gamma=new s(a,"\\Gamma"),c.Gamma.cosetRepresentatives=function(h){let m=c.Gamma_1.cosetRepresentatives(h),d=[];for(let p=0;p<h;p++){let f=new k(1,p,0,1);d.push(...m.map(y=>f.mul(y)))}return d},c.Gamma._cosetRepresentatives=function*(h){let m=yield*c.Gamma_1._cosetRepresentatives(h),d=[];for(let p=0;p<h;p++){yield;let f=new k(1,p,0,1);d.push(...m.map(y=>f.mul(y)))}return d};let u=new g(Math.cos(Math.PI/3),Math.sin(Math.PI/3));c.Domain1={corners:[R,u,new g(0,1),new g(-u.real,u.imag)],findCosetOf(h,m=100){if(h.imag<=0)return;let d=new k(1,0,0,1),p=h;for(var f=0;f<m;f++){if(p==R)return d.inv();var y=Math.floor(p.real+.5);if(d=new k(1,-y,0,1).mul(d),p=d.transform(h),p.abs2()>=1)return d.inv();d=new k(0,1,-1,0).mul(d),p=d.transform(h)}console.log("Max iterations in 'findMoebiousToFund' reached")}}})(J||(J={}));var b;(function(o){o[o.C=0]="C",o[o.T=8]="T",o[o.L=2]="L",o[o.R=1]="R",o[o.B=4]="B",o[o.TL=10]="TL",o[o.TR=9]="TR",o[o.BL=6]="BL",o[o.BR=5]="BR"})(b||(b={}));(function(t){function s(n){return n&12}t.vertical=s;function e(n){return n&3}t.horizontal=e})(b||(b={}));function B(s){if(!s)return;if(typeof s!="string")return s;let e=parseInt("0x"+s.substring(1)),t;s.length===9&&(t=(e&255)/255,e>>=8);let n=255&e,r=255&e>>8,i=255&e>>16;return t===void 0?[i,r,n]:[i,r,n,t]}function F(s){let e={};for(let[t,n]of Object.entries(s))if(n!==void 0)switch(t){case"fill":e.fill=B(n);break;case"stroke":e.stroke=B(n);break;case"lineWidth":e.lineWidth=n;break;case"fontSize":e.fontSize=n;break;default:console.log("Unknown style option '"+t+"'")}return e}function U(s){let e={_backend:s,clear(t){return this._backend.clear(B(t)),this},save(){return this._backend.save(),this},restore(){return this._backend.restore(),this},style(t){return this._backend.style(F(t)),this},path(){return new Q(this._backend.path())},primitive(){var t,n;return new ee(this,(n=(t=this._backend).primitive)==null?void 0:n.call(t))}};return"text"in s&&(e.text=function(){return this._backend.text()}),e}var Q=class{constructor(e){this.backend=e;this.isSet=!1;this.sx=NaN;this.sy=NaN;this.cx=NaN;this.cy=NaN}_c(e,t){this.cx=e,this.cy=t}move(e,t){return this.isSet=!0,this.backend.move(e,t),this.sx=e,this.sy=t,this._c(e,t),this}line(e,t){return this.isSet?(this.backend.line(e,t),this._c(e,t),this):this.move(e,t)}cubic(e,t,n,r,i,a){return this.isSet||this.move(i,a),this.backend.cubic(e,t,n,r,i,a),this._c(i,a),this}quadratic(e,t,n,r){if(this.isSet||this.move(n,r),this.backend.quadratic)this.backend.quadratic(e,t,n,r),this._c(n,r);else{let i=this.cx,a=this.cy;this.backend.cubic(i+2/3*(e-i),a+2/3*(t-a),n+2/3*(e-n),r+2/3*(t-r),n,r),this._c(n,r)}return this}ellipse(e,t,n,r,i,a,l){return this.line(...S(e,t,n,r,i,a)),this.backend.ellipse(e,t,n,r,i,a,l),this._c(...S(e,t,n,r,i,a+l)),this}arc(e,t,n,r,i){return this.backend.arc?(this.line(...S(e,t,n,n,0,r)),this.backend.arc(e,t,n,r,i),this):this.ellipse(e,t,n,n,0,r,i)}close(){if(!this.isSet)throw new Error("No path to close");return this.backend.close(),this._c(this.sx,this.sy),this}draw(e=!0,t=!0){return this.backend.draw(e,t),this}fill(){return this.draw(!1,!0)}stroke(){return this.draw(!0,!1)}clip(){return this.backend.clip(),this}};function j(s){return{draw:(e=!0,t=!0)=>s.draw(e,t),stroke:()=>s.draw(!0,!1),fill:()=>s.draw(!1,!0)}}var ee=class{constructor(e,t){this.r=e;this.b=t}circle(e,t,n,r=0){var a;if((a=this.b)==null?void 0:a.circle)return j(this.b.circle(e,t,n,r));let i=.5*n;switch(b.vertical(r)){case b.T:t-=i;break;case b.B:t+=i;break;case b.C:break}switch(b.horizontal(r)){case b.L:e-=i;break;case b.R:e+=i;break;case b.C:break}return this.r.path().arc(e,t,i,0,.999).close()}square(e,t,n,r=0){var a;if((a=this.b)==null?void 0:a.square)return j(this.b.square(e,t,n,r));let i=.5*n;switch(b.vertical(r)){case b.T:t-=i;break;case b.B:t+=i;break;case b.C:break}switch(b.horizontal(r)){case b.L:e-=i;break;case b.R:e+=i;break;case b.C:break}return this.r.path().move(e-i,t-i).line(e+i,t-i).line(e+i,t+i).line(e-i,t+i).close()}};var E;(function(n){n.from=U,n.toBackendStyle=F,n.Color=B})(E||(E={}));var I=2*Math.PI;function z(s){let e="#"+s[0].toString(16).padStart(2,"0")+s[1].toString(16).padStart(2,"0")+s[2].toString(16).padStart(2,"0");return s[3]&&(e+=Math.round(s[3]*255).toString(16).padStart(2,"0")),e}var te=class{constructor(e){this.ctx=e;this._path=new Path2D}move(e,t){return this._path.moveTo(e,t),this}line(e,t){return this._path.lineTo(e,t),this}cubic(e,t,n,r,i,a){return this._path.bezierCurveTo(e,t,n,r,i,a),this}ellipse(e,t,n,r,i,a,l){return l*=I,a*=I,i*=I,this._path.ellipse(e,t,n,r,-i,-a,-a-l,l>=0),this}close(){return this._path.closePath(),this}draw(e,t){return t&&this.ctx.fill(this._path),e&&this.ctx.stroke(this._path),this}clip(){return this.ctx.clip(this._path),this}},ne=class{constructor(e){this.ctx=e;this.fontSize=9}draw(e,t,n,r=b.C){let i="middle",a="center",l=b.vertical(r),u=b.horizontal(r);switch(l){case b.T:i="top";break;case b.B:i="bottom";break;case b.C:break;default:let o=l}switch(u){case b.L:a="left";break;case b.R:a="right";break;case b.C:break;default:let o=u}return this.ctx.textBaseline=i,this.ctx.textAlign=a,this.ctx.fillText(n,e,t),this}},P=class{constructor(e){this.ctx=e}clear(e){return this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),e&&(this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.fillStyle=z(e),this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()),this}save(){return this.ctx.save(),this}restore(){return this.ctx.restore(),this}style(e){let t;for(let[n,r]of Object.entries(e))switch(n){case"fill":t=r,this.ctx.fillStyle=z(t);break;case"stroke":t=r,this.ctx.strokeStyle=z(t);break;case"lineWidth":this.ctx.lineWidth=r;break;case"fontSize":this.ctx.font=r+"px 'LinuxLibertine', 'Times New Roman', Serif";break;default:console.warn("Style option '"+n+"' not implemented (Canvas backend)")}return this}path(){return new te(this.ctx)}text(){return new ne(this.ctx)}};var re=class{constructor(e,t,...n){this.name=e;this.children=n,this.attributes=t||{}}applyAttributes(...e){for(let t of e)Object.assign(this.attributes,t)}removeAttributes(...e){for(let t of e)delete this.attributes[t]}attrString(){return Object.entries(this.attributes).map(([e,t])=>`${e}="${t}"`).join(" ")}chString(){return this.children.map(e=>e.toString()).join("")}append(...e){this.children.push(...e)}toString(){let e=this.name;return e===""?this.chString():`<${e} ${this.attrString()}>${this.chString()}</${e}>`}};function ie(s,e,...t){return typeof s=="function"?s(e,...t):new re(s,e,...t)}ie.Fragment="";var ae;(function(o){o[o.move=0]="move",o[o.line=1]="line",o[o.cubic=2]="cubic",o[o.quadratic=3]="quadratic",o[o.ellipse=4]="ellipse",o[o.arc=5]="arc",o[o.close=6]="close",o[o.draw=7]="draw",o[o.clip=8]="clip"})(ae||(ae={}));var oe;(function(l){l[l.clear=0]="clear",l[l.clear_color=1]="clear_color",l[l.save=2]="save",l[l.restore=3]="restore",l[l.style=4]="style",l[l.apply=5]="apply",l[l.path=6]="path"})(oe||(oe={}));var le=2*Math.PI;function S(s,e,t,n,r,i){i*=le,r*=le;let a=t*Math.cos(i),l=n*Math.sin(i),u=Math.cos(r),o=Math.sin(r);return[s+u*a-o*l,e-o*a-u*l]}var H=class{constructor(e,t){this.origin=e;this.scale=t}project(e){return Array.isArray(e)&&(e=new g(e[0],e[1])),[e.real*this.scale+this.origin[0],-e.imag*this.scale+this.origin[1]]}invert(e){return new g((e[0]-this.origin[0])/this.scale,-(e[1]-this.origin[1])/this.scale)}addTranslation(e){this.origin=[this.origin[0]+e[0],this.origin[1]+e[1]]}addZoom(e,t){let[n,r]=this.origin;this.origin=[n*e+t[0]*(1-e),r*e+t[1]*(1-e)],this.scale*=e}};function ue(s,e,t,n,r,{arrowSize:i=9}={}){let a=Math.sqrt(r[0]*r[0]+r[1]*r[1]);r=[r[0]/a,r[1]/a];let l=[r[0]===0?-1/0:(0-n[0])/r[0],r[0]===0?1/0:(e-n[0])/r[0],r[1]===0?-1/0:(0-n[1])/r[1],r[1]===0?1/0:(t-n[1])/r[1]].sort((h,m)=>h-m),u=[n[0]+l[1]*r[0],n[1]+l[1]*r[1]],o=[n[0]+(l[2]-1)*r[0],n[1]+(l[2]-1)*r[1]];s.path().move(u[0],u[1]).line(o[0]-2*r[0],o[1]-2*r[1]).stroke();let c=i;return s.path().move(o[0],o[1]).line(o[0]-c*r[0]+.5*c*r[1],o[1]-c*r[1]-.5*c*r[0]).line(o[0]-c*r[0]-.5*c*r[1],o[1]-c*r[1]+.5*c*r[0]).line(o[0],o[1]).fill(),[u[0],u[1],o[0],o[1]]}function me(s,e){let{position:{x:t=0,y:n=0,width:r,height:i},projection:{origin:a,scale:l},arrow:{size:u=7}={},fontSize:o=13,hideX:c=!1,hideY:h=!1,xLabel:m="Re",yLabel:d="Im"}=e;s.style({fontSize:o});let p=function(T,_=0){let{ps:x,ox:fe,oy:ye}=this;return[T*x+fe,-_*x+ye]}.bind({ox:a[0],oy:a[1],ps:l}),f=p(1),y=p(0,1),v=[f[0]-a[0],f[1]-a[1]],w=[y[0]-a[0],y[1]-a[1]];if(!c){let[,,T,_]=ue(s,r,i,a,v,{arrowSize:u});m&&s.text().draw(T-.2*o,_+.2*o+u/2,m,b.TR)}if(!h){let[,,T,_]=ue(s,r,i,a,w,{arrowSize:u});d&&s.text().draw(T-.2*o-u/2,_+.2*o,d,b.TR)}}function he(s,e,{origin:t,scale:n},r,{gap:i=5}={}){var a=s.width||1/0,l=s.height||1/0;if(e=="x"){let u=t[0],o=t[1];for(let c=0;c<r.length;c++){let{at:h,sprite:m}=r[c],d=h*n+u;if(d+m.right>=0&&d-m.left<=a){let p=o,f=d-.5,y=d+.5,v=o+3;s.path().move(f,p).line(y,p).line(y,v).line(f,v).close().fill(),m.draw(s,d,o+m.top+i)}}}}function de(){let s=document.createElement("canvas").getContext("2d");s.textBaseline="middle",s.textAlign="center";let e="PQppqg",t=s.measureText(e),n=t.actualBoundingBoxAscent,r=t.actualBoundingBoxDescent;return{set fontSize(i){s.font=i+"px 'LinuxLibertine', 'Times New Roman', Serif",t=s.measureText(e),n=t.actualBoundingBoxAscent,r=t.actualBoundingBoxDescent},measureText(i){let a=s.measureText(i);return{top:n*1.5,bot:r,left:a.actualBoundingBoxLeft,right:a.actualBoundingBoxRight}}}}function $(s,e,t){let{center:n=!1}=t||{},{top:r,bot:i,left:a,right:l}=s.measureText(e),u=0;return n&&(u=(l-a)/2,a+=u,l-=u),{text:e,dx:u,top:r,bot:i,left:a,right:l,draw:function(c,h,m){"drawText"in c?c.drawText(this.text,h-this.dx,m,0):c.text().draw(h-this.dx,m,this.text)}}}function ce(s,e){let t=.05*(s.top+s.bot+e.top+e.bot),n=.5*(s.left-s.right),r=.5*(e.left-e.right),i=-s.bot-t,a=e.top+t,l=Math.max(.5*(s.left+s.right),.5*(e.left+e.right));return{data:[n,i,r,a,l],top:-i+s.top,bot:a+e.bot,left:l,right:l,draw:function(o,c,h){let[m,d,p,f,y]=this.data;s.draw(o,c+m,h+d),e.draw(o,c+p,h+f),"begin"in o?(o.begin(),o.move(c-y,h),o.line(c+y,h),o.stroke()):o.path().move(c-y,h).line(c+y,h).stroke()}}}var D=class{constructor(e,t,n){this.onDrag=e;this.onZoom=t;this.onHover=n;this.state=new Array;this.down=e=>{if(e.pointerType=="mouse"&&e.button!=0)return;let{pointerId:t,offsetX:n,offsetY:r}=e,i=this.state.find(({id:a})=>a===t);i===void 0&&(i={id:t,x:n,y:r},this.state.push(i)),this.state.length<=1?this.onHover([n,r]):this.onHover(null),e.currentTarget.setPointerCapture(t)};this.move=e=>{let{pointerId:t,offsetX:n,offsetY:r}=e;if(this.state.length===0){this.onHover([n,r]);return}let i=this.state.findIndex(({id:l})=>l===t);if(i===-1)return;let a=this.state[i];if(this.state.length===1)this.onHover([n,r]),this.onDrag([n-a.x,r-a.y]);else if(this.state.length===2){let l=a,u=this.state[1-i],o=L(l.x-u.x,2)+L(l.y-u.y,2),c=L(n-u.x,2)+L(r-u.y,2),h=[.5*(n-l.x),.5*(r-l.y)];this.onHover(null),this.onDrag(h),this.onZoom(c/o,[.5*(n+u.x),.5*(r+u.y)])}a.x=n,a.y=r};this.up=e=>{if(e.pointerType=="mouse"&&e.button!=0)return;let{pointerId:t,offsetX:n,offsetY:r}=e,i=this.state.findIndex(({id:a})=>a===t);this.state.splice(i,1),e.currentTarget.releasePointerCapture(t)};this.cancel=e=>{if(e.pointerType=="mouse"&&e.button!=0)return;let{pointerId:t,offsetX:n,offsetY:r}=e,i=this.state.findIndex(({id:a})=>a===t);this.state.splice(i,1),e.currentTarget.releasePointerCapture(t)};this.leave=e=>{if(e.pointerType=="mouse"&&this.state.length===0&&this.onHover(null),e.pointerType=="mouse"&&e.button!=0||e.currentTarget.hasPointerCapture(e.pointerId))return;let{pointerId:t,offsetX:n,offsetY:r}=e,i=this.state.findIndex(({id:a})=>a===t);this.state.splice(i,1),e.currentTarget.releasePointerCapture(t)};this.wheel=e=>{e.preventDefault(),this.onZoom(Math.exp(-e.deltaY*(e.deltaMode==1?.03333:.001)),[e.offsetX,e.offsetY])}}registerListeners(e){e.addEventListener("pointerup",this.up),e.addEventListener("pointerdown",this.down),e.addEventListener("pointermove",this.move),e.addEventListener("pointercancel",this.cancel),e.addEventListener("pointerleave",this.leave),e.addEventListener("wheel",this.wheel)}removeListeres(e){e.removeEventListener("pointerup",this.up),e.removeEventListener("pointerdown",this.down),e.removeEventListener("pointermove",this.move),e.removeEventListener("pointercancel",this.cancel),e.removeEventListener("wheel",this.wheel)}};function O(s,e=[],t={},n={}){let r=document.createElement(s);for(let[a,l]of Object.entries(t))r.setAttribute(a,typeof l=="string"?l:l+"");for(let[a,l]of Object.entries(n))r[a]=l;if(Array.isArray(e))for(var i of e)typeof i=="string"&&(i=document.createTextNode(i)),r.append(i);else r.innerHTML=e.__html;return r}function A(s,e){for(var t of e)Array.isArray(t)?A(s,t):s.append(t instanceof Node?t:""+t)}function G(s,e,...t){if(s===G.Fragment){let a=document.createDocumentFragment();return A(a,t),a}let n=document.createElement(s);e=e||{},"__html"in e&&(n.innerHTML=""+e.__html,delete e.__html);for(var[r,i]of Object.entries(e))typeof i=="function"?n[r]=i:n.setAttribute(r,""+i);return A(n,t),n}G.Fragment="";var we=`:host{position:relative;top:0;left:0;display:block;width:100%;height:100%;overflow:hidden;padding:0;margin:0}._container_1kdby_13{display:block;position:absolute;width:100%;height:100%;touch-action:none;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}._container_1kdby_13>div,._container_1kdby_13>canvas{position:absolute;top:0;left:0;width:100%;height:100%}
`,xe={container:"_container_1kdby_13"},q={css:we,class:xe};function K(s){return{update(e,t){let n=t.getContext("2d"),r=window.devicePixelRatio;(Math.floor(e.width*r)!==t.width||Math.floor(e.height*r)!==t.height)&&(t.width=Math.floor(e.width*r),t.height=Math.floor(e.height*r)),n.setTransform(r,0,0,r,0,0),s.update(e,n)},resized(e){e.update(this)},connected(e){return{nodes:O("canvas",[],{class:"canvas-layer"})}}}}var pe=class extends HTMLElement{constructor(){super(...arguments);this.shadow=this.attachShadow({mode:"open"});this.cleanup=[]}connectedCallback(){var o,c;let e=this.shadow;e.innerHTML="";let t=O("style",[q.css]),n=O("div",[],{class:q.class.container}),r=new ResizeObserver(()=>{var m,d,p,f;(d=(m=this.layerHandler).resized)==null||d.call(m,u);for(var h of i.values())(f=(p=h.layer)==null?void 0:p.resized)==null||f.call(p,u,h.nodes)});r.observe(n),e.append(t,n);let i=new Map,a=0,l=()=>{var d,p;let h=a===2;a=0;for(var m of i.values())(h||m.update)&&((p=(d=m.layer)==null?void 0:d.update)==null||p.call(d,u,m.nodes)),m.update=!1},u={get width(){return n.clientWidth},get height(){return n.clientHeight},containerElement:n,hostElement:this,update:function(h){if(a!==2){if(a===0&&requestAnimationFrame(l),h===void 0){a=2;return}if(typeof h=="string"){a=1;let d=i.get(h);d&&(d.update=!0);return}for(var m of i.values())h===m.layer&&(m.update=!0)}},addStyles:function(h){t.append(h)},addLayer:function(h,m){if(m instanceof Node){n.appendChild(m);return}let d,p;typeof m=="function"?(p=m(u),d=void 0):(p=m.connected(u),d=m);let f=p.nodes;f&&(Array.isArray(f)?n.append(...f):n.append(f)),i.set(h,{nodes:f,layer:d,update:!1}),u.update(h);let y=p.handle;return y||(y={}),y.update=()=>{this.update(h)},y},attachToShaddow(...h){e.append(...h)}};(c=(o=this.layerHandler).connected)==null||c.call(o,u),this.cleanup.push(()=>{var m,d,p,f;r.unobserve(n);for(var h of i.values())(d=(m=h.layer)==null?void 0:m.disconnected)==null||d.call(m,u);(f=(p=this.layerHandler).disconnected)==null||f.call(p,u)})}disconnectedCallback(){for(var e of this.cleanup)e();this.cleanup=[],this.shadow.innerHTML=""}};function be(s){return class extends pe{constructor(){super(...arguments);this.layerHandler=s}}}window.customElements.define("farey-fractions",be({connected(s){let e=this,t=new H([100,100],100);function n(){let i=t.project(new g(0)),a=t.project(new g(1)),l=Math.abs(i[0]-a[0]),u=!1,{width:o,height:c}=s;i[1]<c/6?(t.addTranslation([0,-i[1]+c/6]),u=!0):i[1]>5*c/6&&(t.addTranslation([0,-i[1]+5*c/6]),u=!0),a[0]<.5*o&&(t.addTranslation([-a[0]+.5*o,0]),u=!0),i[0]>o*.5&&(t.addTranslation([-i[0]+.5*o,0]),u=!0),l<.25*o&&(t.addZoom(.25*o/l,[o/2,c/2]),u=!0),u&&s.update()}new D(i=>{t.addTranslation(i),s.update()},(i,a)=>{let l=t.project(new g(0)),u=t.project(new g(1)),o=Math.abs(l[0]-u[0]);i<=.25*s.width/o&&(i=.25*s.width/o),t.addZoom(i,a),s.update()},()=>{}).registerListeners(s.containerElement),s.addLayer("draw",K({update(i,a){n();let l=E.from(new P(a));a.clearRect(0,0,i.width,i.height),a.lineWidth=1.25,me(l,{position:{width:i.width,height:i.height},projection:t});let u=10,o=de();l.style({fontSize:u}),o.fontSize=u;let c=Te(t.scale,u),h=Math.max(-t.origin[0]/t.scale,1e-11),m=Math.min((i.width-t.origin[0])/t.scale,.99999999999),[d,p,f,y]=_e(c,h),v=Ce(o,[d,p,f,y],c,m);v.push({sprite:$(o,"1",{center:!0}),at:1});for(let w of v);he(l,"x",t,v)}}))}}));function Te(s,e){let t=0,n=1,r=0;for(;;)if(s/((t+n)*(t+n-1))<.75*(1+Math.log10(t+n))*e){if(r==0)return t;t=t+r,n=1,r=0}else r=n,n=n*2}function _e(s,e){let t=Math.floor(e);e=e-t;let n=0,r=1,i=1,a=1;for(;;){let l=i-e*a,u;l!=0&&(u=Math.floor((e*r-n)/l)),(u===void 0||r+u*a>s)&&(u=Math.floor((s-r)/a)),n=n+u*i,r=r+u*a,l=r*e-n;let o;if(l!=0&&(o=Math.floor((i-e*a)/l)),(o===void 0||r*o+a>s)&&(o=Math.floor((s-a)/r)),i=n*o+i,a=r*o+a,u==0&&o==0)break}return[n,r,i,a]}function Ce(s,e,t,n){let r=[],[i,a,l,u]=e;for(;l<n*u;){let o=Math.floor((t+a)/u);[i,a,l,u]=[l,u,o*l-i,o*u-a],r.push({sprite:ce($(s,""+i),$(s,""+a)),at:i/a})}return r}})();
